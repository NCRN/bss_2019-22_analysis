---
title: "bss_figures"
author: "Emma Brentjens"
date: "2025-03-20"
output: html_document
---

```{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = TRUE)

library(dplyr)
library(ggplot2)
library(tidyr)

##score function
mutate_score <- function(data, variable) {
  data %>%
    mutate(Score=case_when(variable<2 ~ "very poor",
                         variable>=2 & variable<3 ~ "poor",
                         variable>=3 & variable<4 ~ "fair",
                         variable>=4 ~ "good"))
}

```

```{r data wrangling}
##loading in FIBI data
FIBI_scores <- read.csv("results_metsc_PTOL.csv")

FIBI_scores <- FIBI_scores %>%
  select(SITE, IBI_PTOL_mod)

colnames(FIBI_scores) <- c("SITE", "FIBI")

missing_fibi <- data.frame(SITE=c("CATO_BLBZ_2010",
                                  "PRWI_BONE_2011",
                                  "PRWI_SFQC_2011",
                                  "PRWI_SORU_2011",
                                  "ROCR_ROC3_2009"),
                           FIBI=c(1, NA, NA, NA, NA))

FIBI_scores1 <- merge(FIBI_scores, missing_fibi,
                        by=c("SITE", 
                             "FIBI"), all=T)

FIBI_scores2 <- FIBI_scores1 %>%
  separate(SITE, into=c("Park", "Stream", "Year")) %>%
  filter(Year>=2008) %>%
  mutate(Cycle=case_when(Year<2019~"1",
                         Year>=2019~"2")) 



##load in BIBI data
BIBI_scores <- read.csv("NPS_BIBI2.csv")

##rows for missing data
missing <- data.frame(SITE=c("NCRN_PRWI_BONE_2011",
                              "NCRN_PRWI_SFQC_2011",
                              "NCRN_PRWI_SORU_2011",
                              "NCRN_ROCR_ROC3_2009"),
                      BIBI=rep(NA, times=4))

BIBI_scores1 <- merge(BIBI_scores, missing,
                        by=c("SITE", 
                             "BIBI"), all=T)

BIBI_scores2 <- BIBI_scores1 %>%
  separate(SITE, into=c("Network", "Park", "Stream", "Year")) %>%
  filter(Year>=2008) %>%
  mutate(Cycle=case_when(Year<2019~"1",
                         Year>=2019~"2")) %>%
  mutate(BIBI=round(BIBI, 2))

```


**Antietam** (FIBI and BIBI corrected)
```{r, echo=F}
##creating dataframe
anti <- data.frame(index=rep(c("FIBI", "BIBI"), each=2),
# old IBI                       IBI=c(3, 3, 1.75, 2),
                        IBI=c(4.3, 4.3, 1.75, 2),
                        Year=rep(c("2013", "2022"), times=2),
                   x_axis=rep(c(1, 2), each=2))
#View(anti)

##adding score column
anti2 <- mutate_score(anti, anti$IBI)
#View(anti2)

##anti graph with black background labels
anti_graph <- ggplot() +
  geom_rect(aes(xmin=0, xmax=3), ymin=4, ymax=5, fill="#7dc7ff", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=3), ymin=3, ymax=4, fill="#8ba7d6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=3), ymin=2, ymax=3, fill="#cf93b6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=3), ymin=1, ymax=2, fill="#f27c7e", alpha=0.5) +
  geom_text(mapping = aes(x = 0.45, y = 4.5, label = "good"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.45, y = 3.5, label = "fair"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.45, y = 2.5, label = "poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.45, y = 1.5, label = "very poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_hline(yintercept=4, linetype="dashed", color="gray55") +
  geom_hline(yintercept=3, linetype="dashed", color="gray55") +
  geom_hline(yintercept=2, linetype="dashed", color="gray55") +
  geom_bar(data=anti2, aes(x=as.factor(x_axis), y=IBI, fill=Year), 
           width=0.7, color="black", size=0.8, position="dodge", stat="identity") +
  scale_fill_manual(labels=c("2013", "2022"), values=c("gray60", "white")) +
  scale_x_discrete(labels=c("Fish Index of\nBiotic Integrity", "Benthic Index of\nBiotic Integrity"))+
  ylab("Score") +
  coord_cartesian(xlim=c(0.3, 2.55), ylim=c(0.8, 5), expand=F) +
  theme_bw(base_size=15) +
  geom_text(data=anti2, aes(x=c(0.825, 1.175, 1.825, 2.175), 
                                 y=IBI, label=IBI), position="dodge", vjust=-0.5, size=6) +
  theme(axis.title.y=element_text(size=20, vjust=+3),
        axis.title.x=element_blank(),
        axis.text.x=element_text(size=18, color="black", vjust=-0.5),
        plot.margin = margin(t = 1, r = 1, b = 1, l = 1, unit = "cm"))

anti_graph

```

*FIBI*
```{r}
##creating fibi dataframe
anti_fibi <- FIBI_scores2 %>%
  filter(Park=="ANTI") %>%
  mutate(x_axis=case_when(Stream=="SHCK"~1))

##creating fibi graph
anti_fibi_graph <- ggplot() +
  geom_rect(aes(xmin=0.4, xmax=1.5), ymin=4, ymax=5, fill="#7dc7ff", alpha=0.5) +
  geom_rect(aes(xmin=0.4, xmax=1.5), ymin=3, ymax=4, fill="#8ba7d6", alpha=0.5) +
  geom_rect(aes(xmin=0.4, xmax=1.5), ymin=2, ymax=3, fill="#cf93b6", alpha=0.5) +
  geom_rect(aes(xmin=0.4, xmax=1.5), ymin=1, ymax=2, fill="#f27c7e", alpha=0.5) +
  geom_text(mapping = aes(x = 0.522, y = 4.5, label = "good"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.522, y = 3.5, label = "fair"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.522, y = 2.5, label = "poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.522, y = 1.5, label = "very poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_hline(yintercept=4, linetype="dashed", color="gray55") +
  geom_hline(yintercept=3, linetype="dashed", color="gray55") +
  geom_hline(yintercept=2, linetype="dashed", color="gray55") +
  geom_bar(data=anti_fibi, aes(x=as.factor(x_axis), y=FIBI, fill=Year), 
           width=0.7, color="black", size=0.8, position="dodge", stat="identity") +
  scale_fill_manual(labels=c("2013", "2022"), values=c("gray60", "white")) +
  scale_x_discrete(label="") +
  ylab("Fish Index of Biotic Integrity") +
  xlab("Sharpsburg Creek") +
  coord_cartesian(xlim=c(0.4, 1.5), ylim=c(0.8, 5), expand=F) +
  theme_bw(base_size=15) +
  geom_text(data=anti_fibi, aes(x=as.factor(x_axis), 
                                 y=FIBI, group=Year, label=FIBI), position=position_dodge2(width=0.7, preserve="total"), vjust=-0.5, size=6) +
  theme(axis.title.y=element_text(size=20, vjust=+3), axis.title.x=element_text(size=15, vjust=4), axis.text.x=element_text(size=14),
        axis.ticks.x=element_blank(),
        plot.margin = margin(t = 1, r = 1, b = 1, l = 1, unit = "cm"))

anti_fibi_graph

##plot dimensions: 600x567

```

*BIBI*
```{r}
##creating bibi dataframe
anti_bibi <- BIBI_scores2 %>%
  filter(Park=="ANTI") %>%
  mutate(x_axis=case_when(Stream=="SHCK"~1))


##creating bibi graph
anti_bibi_graph <- ggplot() +
  geom_rect(aes(xmin=0.4, xmax=1.5), ymin=4, ymax=5, fill="#7dc7ff", alpha=0.5) +
  geom_rect(aes(xmin=0.4, xmax=1.5), ymin=3, ymax=4, fill="#8ba7d6", alpha=0.5) +
  geom_rect(aes(xmin=0.4, xmax=1.5), ymin=2, ymax=3, fill="#cf93b6", alpha=0.5) +
  geom_rect(aes(xmin=0.4, xmax=1.5), ymin=1, ymax=2, fill="#f27c7e", alpha=0.5) +
  geom_text(mapping = aes(x = 0.522, y = 4.5, label = "good"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.522, y = 3.5, label = "fair"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.522, y = 2.5, label = "poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.522, y = 1.5, label = "very poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_hline(yintercept=4, linetype="dashed", color="gray55") +
  geom_hline(yintercept=3, linetype="dashed", color="gray55") +
  geom_hline(yintercept=2, linetype="dashed", color="gray55") +
  geom_bar(data=anti_bibi, aes(x=as.factor(x_axis), y=BIBI, fill=Year), 
           width=0.7, color="black", size=0.8, position="dodge", stat="identity") +
  scale_fill_manual(labels=c("2013", "2022"), values=c("gray60", "white")) +
  scale_x_discrete(label="") +
  ylab("Benthic Index of Biotic Integrity") +
  xlab("Sharpsburg Creek") +
  coord_cartesian(xlim=c(0.4, 1.5), ylim=c(0.8, 5), expand=F) +
  theme_bw(base_size=15) +
  geom_text(data=anti_bibi, aes(x=as.factor(x_axis), 
                                 y=BIBI, group=Year, label=BIBI), position=position_dodge2(width=0.7, preserve="total"), vjust=-0.5, size=6) +
  theme(axis.title.y=element_text(size=20, vjust=+3), axis.title.x=element_text(size=15, vjust=4), axis.text.x=element_text(size=14),
        axis.ticks.x=element_blank(),
        plot.margin = margin(t = 1, r = 1, b = 1, l = 1, unit = "cm"))

anti_bibi_graph

```


**Catoctin** 
*FIBI* (corrected)
```{r, echo=F}
##creating fibi dataframe
cato_fibi <- FIBI_scores2 %>%
  filter(Park=="CATO") %>%
  mutate(x_axis=case_when(Stream=="BGHC"~1,
                          Stream=="BLBZ"~2,
                          Stream=="OWCK"~3)) %>%
  mutate(stream_name=case_when(Stream=="BGHC"~"Big Hunting\nCreek",
                               Stream=="BLBZ"~"Blue Blazes\nCreek",
                               Stream=="OWCK"~"Owens Creek"))


##creating fibi graph
cato_fibi_graph <- ggplot() +
  geom_rect(aes(xmin=0, xmax=4), ymin=4, ymax=5, fill="#7dc7ff", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=4), ymin=3, ymax=4, fill="#8ba7d6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=4), ymin=2, ymax=3, fill="#cf93b6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=4), ymin=1, ymax=2, fill="#f27c7e", alpha=0.5) +
  geom_text(mapping = aes(x = 0.4, y = 4.5, label = "good"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.4, y = 3.5, label = "fair"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.4, y = 2.5, label = "poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.4, y = 1.5, label = "very poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_hline(yintercept=4, linetype="dashed", color="gray55") +
  geom_hline(yintercept=3, linetype="dashed", color="gray55") +
  geom_hline(yintercept=2, linetype="dashed", color="gray55") +
  geom_bar(data=cato_fibi, aes(x=as.factor(x_axis), y=FIBI, fill=Year), 
           width=0.7, color="black", size=0.8, position="dodge", stat="identity") +
  scale_fill_manual(labels=c("2010", "2022"), values=c("gray60", "white")) +
  scale_x_discrete(name="Stream", labels=c((cato_fibi %>% group_by(stream_name) %>%
                                              summarise(mean_fibi <- mean(FIBI)))$stream_name))+
  ylab("Fish Index of Biotic Integrity") +
  coord_cartesian(xlim=c(0.2, 3.6), ylim=c(0.8, 5), expand=F) +
  theme_bw(base_size=15) +
  geom_text(data=cato_fibi, aes(x=as.factor(x_axis), y=FIBI,
                                group=Year, label=FIBI), position=position_dodge2(width=0.7, preserve="total"), vjust=-0.5, size=5) +
  theme(axis.title.y=element_text(size=20, vjust=+3),
        axis.title.x=element_text(size=20, vjust=-0.75),
        axis.text.x=element_text(size=14),
        plot.margin = margin(t = 1, r = 1, b = 1, l = 1, unit = "cm"))

cato_fibi_graph

```

*BIBI* (corrected)
```{r, echo=F}
##creating bibi dataframe
cato_bibi <- BIBI_scores2 %>%
  filter(Park=="CATO") %>%
  mutate(x_axis=case_when(Stream=="BGHC"~1,
                          Stream=="BLBZ"~2,
                          Stream=="OWCK"~3)) %>%
  mutate(stream_name=case_when(Stream=="BGHC"~"Big Hunting\nCreek",
                               Stream=="BLBZ"~"Blue Blazes\nCreek",
                               Stream=="OWCK"~"Owens Creek"))


##creating bibi graph
cato_bibi_graph <- ggplot() +
  geom_rect(aes(xmin=0, xmax=4), ymin=4, ymax=5, fill="#7dc7ff", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=4), ymin=3, ymax=4, fill="#8ba7d6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=4), ymin=2, ymax=3, fill="#cf93b6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=4), ymin=1, ymax=2, fill="#f27c7e", alpha=0.5) +
  geom_text(mapping = aes(x = 0.4, y = 4.5, label = "good"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.4, y = 3.5, label = "fair"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.4, y = 2.5, label = "poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.4, y = 1.5, label = "very poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_hline(yintercept=4, linetype="dashed", color="gray55") +
  geom_hline(yintercept=3, linetype="dashed", color="gray55") +
  geom_hline(yintercept=2, linetype="dashed", color="gray55") +
  geom_bar(data=cato_bibi, aes(x=as.factor(x_axis), y=BIBI, fill=Year), 
           width=0.7, color="black", size=0.8, position="dodge", stat="identity") +
  scale_fill_manual(labels=c("2010", "2022"), values=c("gray60", "white")) +
  scale_x_discrete(name="Stream", labels=c((cato_bibi %>% group_by(stream_name) %>%
                                              summarise(mean_bibi <- mean(BIBI)))$stream_name))+
  ylab("Benthic Index of Biotic Integrity") +
  coord_cartesian(xlim=c(0.2, 3.6), ylim=c(0.8, 5), expand=F) +
  theme_bw(base_size=15) +
  geom_text(data=cato_bibi, aes(x=as.factor(x_axis), y=BIBI,
                                group=Year, label=BIBI), position=position_dodge2(width=0.7, preserve="total"), vjust=-0.5, size=5) +
  theme(axis.title.y=element_text(size=20, vjust=+3),
        axis.title.x=element_text(size=20, vjust=-0.75),
        axis.text.x=element_text(size=14),
        plot.margin = margin(t = 1, r = 1, b = 1, l = 1, unit = "cm"))

cato_bibi_graph

```


**George Washington Memorial Parkway** 
*FIBI* (corrected)
```{r, echo=F}
##creating fibi dataframe
gwmp_fibi <- FIBI_scores2 %>%
  filter(Park=="GWMP") %>%
  mutate(x_axis=case_when(Stream=="MIRU"~1,
                          Stream=="MICR"~2,
                          Stream=="PIRU"~3,
                          Stream=="TURU"~4)) %>%
  mutate(stream_name=case_when(Stream=="MIRU"~"Mine Run",
                               Stream=="MICR"~"Minnehaha\nCreek*",
                               Stream=="PIRU"~"Pimmit Run",
                               Stream=="TURU"~"Turkey Run"))


##creating fibi graph
gwmp_fibi_graph <- ggplot() +
  geom_rect(aes(xmin=0, xmax=5), ymin=4, ymax=5, fill="#7dc7ff", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=5), ymin=3, ymax=4, fill="#8ba7d6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=5), ymin=2, ymax=3, fill="#cf93b6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=5), ymin=1, ymax=2, fill="#f27c7e", alpha=0.5) +
  geom_text(mapping = aes(x = 0.35, y = 4.5, label = "good"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.35, y = 3.5, label = "fair"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.35, y = 2.5, label = "poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.35, y = 1.5, label = "very poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_hline(yintercept=4, linetype="dashed", color="gray55") +
  geom_hline(yintercept=3, linetype="dashed", color="gray55") +
  geom_hline(yintercept=2, linetype="dashed", color="gray55") +
  geom_bar(data=gwmp_fibi, aes(x=as.factor(x_axis), y=FIBI, fill=Cycle), 
           width=0.7, color="black", size=0.8, position="dodge", stat="identity") +
  scale_fill_manual(labels=c("2012 (*2014)", "2022"), values=c("gray60", "white")) +
  scale_x_discrete(name="Stream", labels=c((gwmp_fibi %>% group_by(stream_name) %>%
                                              summarise(mean_fibi <- mean(FIBI)))$stream_name))+
  ylab("Fish Index of Biotic Integrity") +
  coord_cartesian(xlim=c(0.1, 4.6), ylim=c(0.8, 5), expand=F) +
  theme_bw(base_size=15) +
  geom_text(data=gwmp_fibi, aes(x=as.factor(x_axis), y=FIBI,
                                group=Year, label=FIBI), position=position_dodge2(width=0.7, preserve="total"), vjust=-0.5, size=4.75) +
  theme(axis.title.y=element_text(size=20, vjust=+3), axis.title.x=element_text(size=20, vjust=-0.75), axis.text.x=element_text(size=14),
        plot.margin = margin(t = 1, r = 1, b = 1, l = 1, unit = "cm"))

gwmp_fibi_graph

```

*BIBI* (corrected)
```{r, echo=F}
##creating bibi dataframe
gwmp_bibi <- BIBI_scores2 %>%
  filter(Park=="GWMP") %>%
  mutate(x_axis=case_when(Stream=="MIRU"~1,
                          Stream=="MICR"~2,
                          Stream=="PIRU"~3,
                          Stream=="TURU"~4)) %>%
  mutate(stream_name=case_when(Stream=="MIRU"~"Mine Run",
                               Stream=="MICR"~"Minnehaha\nCreek*",
                               Stream=="PIRU"~"Pimmit Run",
                               Stream=="TURU"~"Turkey Run"))


##creating bibi graph
gwmp_bibi_graph <- ggplot() +
  geom_rect(aes(xmin=0, xmax=5), ymin=4, ymax=5, fill="#7dc7ff", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=5), ymin=3, ymax=4, fill="#8ba7d6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=5), ymin=2, ymax=3, fill="#cf93b6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=5), ymin=1, ymax=2, fill="#f27c7e", alpha=0.5) +
  geom_text(mapping = aes(x = 0.35, y = 4.5, label = "good"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.35, y = 3.5, label = "fair"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.35, y = 2.5, label = "poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.35, y = 1.5, label = "very poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_hline(yintercept=4, linetype="dashed", color="gray55") +
  geom_hline(yintercept=3, linetype="dashed", color="gray55") +
  geom_hline(yintercept=2, linetype="dashed", color="gray55") +
  geom_bar(data=gwmp_bibi, aes(x=as.factor(x_axis), y=BIBI, fill=Cycle), 
           width=0.7, color="black", size=0.8, position="dodge", stat="identity") +
  scale_fill_manual(labels=c("2012 (*2014)", "2022"), values=c("gray60", "white")) +
  scale_x_discrete(name="Stream", labels=c((gwmp_bibi %>% group_by(stream_name) %>%
                                              summarise(mean_bibi <- mean(BIBI)))$stream_name))+
  ylab("Benthic Index of Biotic Integrity") +
  coord_cartesian(xlim=c(0.1, 4.6), ylim=c(0.8, 5), expand=F) +
  theme_bw(base_size=15) +
  geom_text(data=gwmp_bibi, aes(x=as.factor(x_axis), y=BIBI,
                                group=Year, label=BIBI), position=position_dodge2(width=0.7, preserve="total"), vjust=-0.5, size=4.75) +
  theme(axis.title.y=element_text(size=20, vjust=+3), axis.title.x=element_text(size=20, vjust=-0.75), axis.text.x=element_text(size=14),
        plot.margin = margin(t = 1, r = 1, b = 1, l = 1, unit = "cm"))

gwmp_bibi_graph

```


**Harpers Ferry** (FIBI and BIBI corrected)
```{r, echo=F}
##creating dataframe
hafe <- data.frame(index=rep(c("FIBI", "BIBI"), each=2),
                        IBI=c(3, 3.7, 1.5, 1.5),
                        Year=rep(c("2013", "2022"), times=2),
                   x_axis=rep(c(1, 2), each=2))
#View(hafe)

##adding score column
hafe2 <- mutate_score(hafe, hafe$IBI)
#View(hafe2)

##creating graph
hafe_graph <- ggplot() +
  geom_rect(aes(xmin=0, xmax=3), ymin=4, ymax=5, fill="#7dc7ff", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=3), ymin=3, ymax=4, fill="#8ba7d6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=3), ymin=2, ymax=3, fill="#cf93b6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=3), ymin=1, ymax=2, fill="#f27c7e", alpha=0.5) +
  geom_text(mapping = aes(x = 0.45, y = 4.5, label = "good"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.45, y = 3.5, label = "fair"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.45, y = 2.5, label = "poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.45, y = 1.5, label = "very poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_hline(yintercept=4, linetype="dashed", color="gray55") +
  geom_hline(yintercept=3, linetype="dashed", color="gray55") +
  geom_hline(yintercept=2, linetype="dashed", color="gray55") +
  geom_bar(data=hafe2, aes(x=as.factor(x_axis), y=IBI, fill=Year), 
           width=0.7, color="black", size=0.8, position="dodge", stat="identity") +
  scale_fill_manual(labels=c("2013", "2022"), values=c("gray60", "white")) +
  scale_x_discrete(labels=c("Fish Index of\nBiotic Integrity", "Benthic Index of\nBiotic Integrity"))+
  ylab("Score") +
  coord_cartesian(xlim=c(0.3, 2.55), ylim=c(0.8, 5), expand=F) +
  theme_bw(base_size=15) +
  geom_text(data=hafe2, aes(x=c(0.825, 1.175, 1.825, 2.175), 
                                 y=IBI, label=IBI), position="dodge", vjust=-0.5, size=6) +
  theme(axis.title.y=element_text(size=20, vjust=+3), axis.title.x=element_blank(),
        axis.text.x=element_text(size=18, color="black", vjust=-0.5),
        plot.margin = margin(t = 1, r = 1, b = 1, l = 1, unit = "cm"))

hafe_graph

```

*FIBI*
```{r}
##creating fibi dataframe
hafe_fibi <- FIBI_scores2 %>%
  filter(Park=="HAFE") %>%
  mutate(x_axis=case_when(Stream=="FLSP"~1)) 

##creating fibi graph
hafe_fibi_graph <- ggplot() +
  geom_rect(aes(xmin=0.4, xmax=1.5), ymin=4, ymax=5, fill="#7dc7ff", alpha=0.5) +
  geom_rect(aes(xmin=0.4, xmax=1.5), ymin=3, ymax=4, fill="#8ba7d6", alpha=0.5) +
  geom_rect(aes(xmin=0.4, xmax=1.5), ymin=2, ymax=3, fill="#cf93b6", alpha=0.5) +
  geom_rect(aes(xmin=0.4, xmax=1.5), ymin=1, ymax=2, fill="#f27c7e", alpha=0.5) +
  geom_text(mapping = aes(x = 0.522, y = 4.5, label = "good"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.522, y = 3.5, label = "fair"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.522, y = 2.5, label = "poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.522, y = 1.5, label = "very poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_hline(yintercept=4, linetype="dashed", color="gray55") +
  geom_hline(yintercept=3, linetype="dashed", color="gray55") +
  geom_hline(yintercept=2, linetype="dashed", color="gray55") +
  geom_bar(data=hafe_fibi, aes(x=as.factor(x_axis), y=FIBI, fill=Year), 
           width=0.7, color="black", size=0.8, position="dodge", stat="identity") +
  scale_fill_manual(labels=c("2013", "2022"), values=c("gray60", "white")) +
  scale_x_discrete(label="") +
  ylab("Fish Index of Biotic Integrity") +
  xlab("Flowing Springs Run") +
  coord_cartesian(xlim=c(0.4, 1.5), ylim=c(0.8, 5), expand=F) +
  theme_bw(base_size=15) +
  geom_text(data=hafe_fibi, aes(x=as.factor(x_axis), 
                                 y=FIBI, group=Year, label=FIBI), position=position_dodge2(width=0.7, preserve="total"), vjust=-0.5, size=6) +
  theme(axis.title.y=element_text(size=20, vjust=+3), axis.title.x=element_text(size=15, vjust=4), axis.text.x=element_text(size=14),
        axis.ticks.x=element_blank(),
        plot.margin = margin(t = 1, r = 1, b = 1, l = 1, unit = "cm"))

hafe_fibi_graph

```

*BIBI*
```{r}
##creating bibi dataframe
hafe_bibi <- BIBI_scores2 %>%
  filter(Park=="HAFE") %>%
  mutate(x_axis=case_when(Stream=="FLSP"~1)) 

##creating bibi graph
hafe_bibi_graph <- ggplot() +
  geom_rect(aes(xmin=0.4, xmax=1.5), ymin=4, ymax=5, fill="#7dc7ff", alpha=0.5) +
  geom_rect(aes(xmin=0.4, xmax=1.5), ymin=3, ymax=4, fill="#8ba7d6", alpha=0.5) +
  geom_rect(aes(xmin=0.4, xmax=1.5), ymin=2, ymax=3, fill="#cf93b6", alpha=0.5) +
  geom_rect(aes(xmin=0.4, xmax=1.5), ymin=1, ymax=2, fill="#f27c7e", alpha=0.5) +
  geom_text(mapping = aes(x = 0.522, y = 4.5, label = "good"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.522, y = 3.5, label = "fair"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.522, y = 2.5, label = "poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.522, y = 1.5, label = "very poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_hline(yintercept=4, linetype="dashed", color="gray55") +
  geom_hline(yintercept=3, linetype="dashed", color="gray55") +
  geom_hline(yintercept=2, linetype="dashed", color="gray55") +
  geom_bar(data=hafe_bibi, aes(x=as.factor(x_axis), y=BIBI, fill=Year), 
           width=0.7, color="black", size=0.8, position="dodge", stat="identity") +
  scale_fill_manual(labels=c("2013", "2022"), values=c("gray60", "white")) +
  scale_x_discrete(label="") +
  ylab("Benthic Index of Biotic Integrity") +
  xlab("Flowing Springs Run") +
  coord_cartesian(xlim=c(0.4, 1.5), ylim=c(0.8, 5), expand=F) +
  theme_bw(base_size=15) +
  geom_text(data=hafe_bibi, aes(x=as.factor(x_axis), 
                                 y=BIBI, group=Year, label=BIBI), position=position_dodge2(width=0.7, preserve="total"), vjust=-0.5, size=6) +
  theme(axis.title.y=element_text(size=20, vjust=+3), axis.title.x=element_text(size=15, vjust=4), axis.text.x=element_text(size=14),
        axis.ticks.x=element_blank(),
        plot.margin = margin(t = 1, r = 1, b = 1, l = 1, unit = "cm"))

hafe_bibi_graph

```


**Manassas** (FIBI and BIBI corrected)
```{r, echo=F}
##creating dataframe
mana <- data.frame(index=rep(c("FIBI", "BIBI"), each=2),
                        IBI=c(2.7, 3, 3, 4),
                        Year=rep(c("2010", "2022"), times=2),
                   x_axis=rep(c(1, 2), each=2))
#View(mana)

##adding score column
mana2 <- mutate_score(mana, mana$IBI)
#View(mana2)

##creating graph
mana_graph <- ggplot() +
  geom_rect(aes(xmin=0, xmax=3), ymin=4, ymax=5, fill="#7dc7ff", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=3), ymin=3, ymax=4, fill="#8ba7d6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=3), ymin=2, ymax=3, fill="#cf93b6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=3), ymin=1, ymax=2, fill="#f27c7e", alpha=0.5) +
  geom_text(mapping = aes(x = 0.45, y = 4.5, label = "good"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.45, y = 3.5, label = "fair"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.45, y = 2.5, label = "poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.45, y = 1.5, label = "very poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_hline(yintercept=4, linetype="dashed", color="gray55") +
  geom_hline(yintercept=3, linetype="dashed", color="gray55") +
  geom_hline(yintercept=2, linetype="dashed", color="gray55") +
  geom_bar(data=mana2, aes(x=as.factor(x_axis), y=IBI, fill=Year), 
           width=0.7, color="black", size=0.8, position="dodge", stat="identity") +
  scale_fill_manual(labels=c("2010", "2022"), values=c("gray60", "white")) +
  scale_x_discrete(labels=c("Fish Index of\nBiotic Integrity", "Benthic Index of\nBiotic Integrity"))+
  ylab("Score") +
  coord_cartesian(xlim=c(0.3, 2.55), ylim=c(0.8, 5), expand=F) +
  theme_bw(base_size=15) +
  geom_text(data=mana2, aes(x=c(0.825, 1.175, 1.825, 2.175), 
                                 y=IBI, label=IBI), position="dodge", vjust=-0.5, size=6) +
  theme(axis.title.y=element_text(size=20, vjust=+3), axis.title.x=element_blank(),
        axis.text.x=element_text(size=18, color="black", vjust=-0.5),
        plot.margin = margin(t = 1, r = 1, b = 1, l = 1, unit = "cm"))

mana_graph

```

*FIBI*
```{r}
##creating fibi dataframe
mana_fibi <- FIBI_scores2 %>%
  filter(Park=="MANA") %>%
  mutate(x_axis=case_when(Stream=="YOBR"~1))

##creating fibi graph
mana_fibi_graph <- ggplot() +
  geom_rect(aes(xmin=0.4, xmax=1.5), ymin=4, ymax=5, fill="#7dc7ff", alpha=0.5) +
  geom_rect(aes(xmin=0.4, xmax=1.5), ymin=3, ymax=4, fill="#8ba7d6", alpha=0.5) +
  geom_rect(aes(xmin=0.4, xmax=1.5), ymin=2, ymax=3, fill="#cf93b6", alpha=0.5) +
  geom_rect(aes(xmin=0.4, xmax=1.5), ymin=1, ymax=2, fill="#f27c7e", alpha=0.5) +
  geom_text(mapping = aes(x = 0.522, y = 4.5, label = "good"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.522, y = 3.5, label = "fair"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.522, y = 2.5, label = "poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.522, y = 1.5, label = "very poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_hline(yintercept=4, linetype="dashed", color="gray55") +
  geom_hline(yintercept=3, linetype="dashed", color="gray55") +
  geom_hline(yintercept=2, linetype="dashed", color="gray55") +
  geom_bar(data=mana_fibi, aes(x=as.factor(x_axis), y=FIBI, fill=Year), 
           width=0.7, color="black", size=0.8, position="dodge", stat="identity") +
  scale_fill_manual(labels=c("2010", "2022"), values=c("gray60", "white")) +
  scale_x_discrete(label="") +
  ylab("Fish Index of Biotic Integrity") +
  xlab("Young's Branch") +
  coord_cartesian(xlim=c(0.4, 1.5), ylim=c(0.8, 5), expand=F) +
  theme_bw(base_size=15) +
  geom_text(data=mana_fibi, aes(x=as.factor(x_axis), 
                                 y=FIBI, group=Year, label=FIBI), position=position_dodge2(width=0.7, preserve="total"), vjust=-0.5, size=6) +
  theme(axis.title.y=element_text(size=20, vjust=+3), axis.title.x=element_text(size=15, vjust=4), axis.text.x=element_text(size=14),
        axis.ticks.x=element_blank(),
        plot.margin = margin(t = 1, r = 1, b = 1, l = 1, unit = "cm"))

mana_fibi_graph

##plot dimensions: 600x567

```

*BIBI*
```{r}
##creating bibi dataframe
mana_bibi <- BIBI_scores2 %>%
  filter(Park=="MANA") %>%
  mutate(x_axis=case_when(Stream=="YOBR"~1))

##creating bibi graph
mana_bibi_graph <- ggplot() +
  geom_rect(aes(xmin=0.4, xmax=1.5), ymin=4, ymax=5, fill="#7dc7ff", alpha=0.5) +
  geom_rect(aes(xmin=0.4, xmax=1.5), ymin=3, ymax=4, fill="#8ba7d6", alpha=0.5) +
  geom_rect(aes(xmin=0.4, xmax=1.5), ymin=2, ymax=3, fill="#cf93b6", alpha=0.5) +
  geom_rect(aes(xmin=0.4, xmax=1.5), ymin=1, ymax=2, fill="#f27c7e", alpha=0.5) +
  geom_text(mapping = aes(x = 0.522, y = 4.5, label = "good"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.522, y = 3.5, label = "fair"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.522, y = 2.5, label = "poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.522, y = 1.5, label = "very poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_hline(yintercept=4, linetype="dashed", color="gray55") +
  geom_hline(yintercept=3, linetype="dashed", color="gray55") +
  geom_hline(yintercept=2, linetype="dashed", color="gray55") +
  geom_bar(data=mana_bibi, aes(x=as.factor(x_axis), y=BIBI, fill=Year), 
           width=0.7, color="black", size=0.8, position="dodge", stat="identity") +
  scale_fill_manual(labels=c("2010", "2022"), values=c("gray60", "white")) +
  scale_x_discrete(label="") +
  ylab("Benthic Index of Biotic Integrity") +
  xlab("Young's Branch") +
  coord_cartesian(xlim=c(0.4, 1.5), ylim=c(0.8, 5), expand=F) +
  theme_bw(base_size=15) +
  geom_text(data=mana_bibi, aes(x=as.factor(x_axis), 
                                 y=BIBI, group=Year, label=BIBI), position=position_dodge2(width=0.7, preserve="total"), vjust=-0.5, size=6) +
  theme(axis.title.y=element_text(size=20, vjust=+3), axis.title.x=element_text(size=15, vjust=4), axis.text.x=element_text(size=14),
        axis.ticks.x=element_blank(),
        plot.margin = margin(t = 1, r = 1, b = 1, l = 1, unit = "cm"))

mana_bibi_graph

```


**Monocacy** 
*FIBI* (corrected)
```{r, echo=F}
##creating fibi dataframe
mono_fibi <- FIBI_scores2 %>%
  filter(Park=="MONO") %>%
  mutate(x_axis=case_when(Stream=="BUCK"~1,
                          Stream=="GAMI"~2)) %>%
  mutate(stream_name=case_when(Stream=="BUCK"~"Bush Creek",
                               Stream=="GAMI"~"Gambrill Mill Creek"))


##creating fibi graph
mono_fibi_graph <- ggplot() +
  geom_rect(aes(xmin=0, xmax=3), ymin=4, ymax=5, fill="#7dc7ff", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=3), ymin=3, ymax=4, fill="#8ba7d6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=3), ymin=2, ymax=3, fill="#cf93b6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=3), ymin=1, ymax=2, fill="#f27c7e", alpha=0.5) +
  geom_text(mapping = aes(x = 0.45, y = 4.5, label = "good"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.45, y = 3.5, label = "fair"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.45, y = 2.5, label = "poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.45, y = 1.5, label = "very poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_hline(yintercept=4, linetype="dashed", color="gray55") +
  geom_hline(yintercept=3, linetype="dashed", color="gray55") +
  geom_hline(yintercept=2, linetype="dashed", color="gray55") +
  geom_bar(data=mono_fibi, aes(x=as.factor(x_axis), y=FIBI, fill=Year), 
           width=0.7, color="black", size=0.8, position="dodge", stat="identity") +
  scale_fill_manual(labels=c("2010", "2022"), values=c("gray60", "white")) +
  scale_x_discrete(name="Stream", labels=c((mono_fibi %>% group_by(stream_name) %>%
                                              summarise(mean_fibi <- mean(FIBI)))$stream_name))+
  ylab("Fish Index of Biotic Integrity") +
  coord_cartesian(xlim=c(0.3, 2.55), ylim=c(0.8, 5.01), expand=F) +
  theme_bw(base_size=15) +
  geom_text(data=mono_fibi, aes(x=as.factor(x_axis), y=FIBI,
                                group=Year, label=FIBI), position=position_dodge2(width=0.7, preserve="total"), vjust=-0.5, size=6) +
  theme(axis.title.y=element_text(size=20, vjust=+3), axis.title.x=element_text(size=20, vjust=-0.75), axis.text.x=element_text(size=16),
        plot.margin = margin(t = 1, r = 1, b = 1, l = 1, unit = "cm"))

mono_fibi_graph

##plot dimensions: 725x567

```

*BIBI* (corrected)
```{r, echo=F}
##creating bibi dataframe
mono_bibi <- BIBI_scores2 %>%
  filter(Park=="MONO") %>%
  mutate(x_axis=case_when(Stream=="BUCK"~1,
                          Stream=="GAMI"~2)) %>%
  mutate(stream_name=case_when(Stream=="BUCK"~"Bush Creek",
                               Stream=="GAMI"~"Gambrill Mill Creek"))


##creating bibi graph
mono_bibi_graph <- ggplot() +
  geom_rect(aes(xmin=0, xmax=3), ymin=4, ymax=5, fill="#7dc7ff", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=3), ymin=3, ymax=4, fill="#8ba7d6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=3), ymin=2, ymax=3, fill="#cf93b6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=3), ymin=1, ymax=2, fill="#f27c7e", alpha=0.5) +
  geom_text(mapping = aes(x = 0.45, y = 4.5, label = "good"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.45, y = 3.5, label = "fair"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.45, y = 2.5, label = "poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.45, y = 1.5, label = "very poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_hline(yintercept=4, linetype="dashed", color="gray55") +
  geom_hline(yintercept=3, linetype="dashed", color="gray55") +
  geom_hline(yintercept=2, linetype="dashed", color="gray55") +
  geom_bar(data=mono_bibi, aes(x=as.factor(x_axis), y=BIBI, fill=Year), 
           width=0.7, color="black", size=0.8, position="dodge", stat="identity") +
  scale_fill_manual(labels=c("2010", "2022"), values=c("gray60", "white")) +
  scale_x_discrete(name="Stream", labels=c((mono_bibi %>% group_by(stream_name) %>%
                                              summarise(mean_bibi <- mean(BIBI)))$stream_name))+
  ylab("Benthic Index of Biotic Integrity") +
  coord_cartesian(xlim=c(0.3, 2.55), ylim=c(0.8, 5.01), expand=F) +
  theme_bw(base_size=15) +
  geom_text(data=mono_bibi, aes(x=as.factor(x_axis), y=BIBI,
                                group=Year, label=BIBI), position=position_dodge2(width=0.7, preserve="total"), vjust=-0.5, size=6) +
  theme(axis.title.y=element_text(size=20, vjust=+3), axis.title.x=element_text(size=20, vjust=-0.75), axis.text.x=element_text(size=16),
        plot.margin = margin(t = 1, r = 1, b = 1, l = 1, unit = "cm"))

mono_bibi_graph

```


**National Capital Parks- East**
*FIBI* (corrected)
```{r, echo=F}
##creating fibi dataframe
nace_fibi <- FIBI_scores2 %>%
  filter(Park=="NACE") %>%
  filter(Stream!="ACCK") %>%
  mutate(x_axis=case_when(Stream=="HECR"~1,
                          Stream=="OXRU"~2,
                          Stream=="STCK"~3)) %>%
  mutate(stream_name=case_when(Stream=="HECR"~"Henson Creek",
                               Stream=="OXRU"~"Oxon Run",
                               Stream=="STCK"~"Still Creek"))


##creating fibi graph
nace_fibi_graph <- ggplot() +
  geom_rect(aes(xmin=0, xmax=4), ymin=4, ymax=5, fill="#7dc7ff", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=4), ymin=3, ymax=4, fill="#8ba7d6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=4), ymin=2, ymax=3, fill="#cf93b6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=4), ymin=1, ymax=2, fill="#f27c7e", alpha=0.5) +
  geom_text(mapping = aes(x = 0.4, y = 4.5, label = "good"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.4, y = 3.5, label = "fair"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.4, y = 2.5, label = "poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.4, y = 1.5, label = "very poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_hline(yintercept=4, linetype="dashed", color="gray55") +
  geom_hline(yintercept=3, linetype="dashed", color="gray55") +
  geom_hline(yintercept=2, linetype="dashed", color="gray55") +
  geom_bar(data=nace_fibi, aes(x=as.factor(x_axis), y=FIBI, fill=Year), 
           width=0.7, color="black", size=0.8, position="dodge", stat="identity") +
  scale_fill_manual(labels=c("2013", "2022"), values=c("gray60", "white")) +
  scale_x_discrete(name="Stream", labels=c((nace_fibi %>% group_by(stream_name) %>%
                                              summarise(mean_fibi <- mean(FIBI)))$stream_name))+
  ylab("Fish Index of Biotic Integrity") +
  coord_cartesian(xlim=c(0.2, 3.6), ylim=c(0.8, 5), expand=F) +
  theme_bw(base_size=15) +
  geom_text(data=nace_fibi, aes(x=as.factor(x_axis), y=FIBI,
                                group=Year, label=FIBI), position=position_dodge2(width=0.7, preserve="total"), vjust=-0.5, size=6) +
  theme(axis.title.y=element_text(size=20, vjust=+3), axis.title.x=element_text(size=20, vjust=-0.75), axis.text.x=element_text(size=15),
        plot.margin = margin(t = 1, r = 1, b = 1, l = 1, unit = "cm"))

nace_fibi_graph

##plot dimensions: 783x567

```

*BIBI* (corrected)
```{r, echo=F}
##creating bibi dataframe
nace_bibi <- BIBI_scores2 %>%
  filter(Park=="NACE") %>%
  filter(Stream!="ACCK") %>%
  mutate(x_axis=case_when(Stream=="HECR"~1,
                          Stream=="OXRU"~2,
                          Stream=="STCK"~3)) %>%
  mutate(stream_name=case_when(Stream=="HECR"~"Henson Creek",
                               Stream=="OXRU"~"Oxon Run",
                               Stream=="STCK"~"Still Creek"))


##creating bibi graph
nace_bibi_graph <- ggplot() +
  geom_rect(aes(xmin=0, xmax=4), ymin=4, ymax=5, fill="#7dc7ff", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=4), ymin=3, ymax=4, fill="#8ba7d6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=4), ymin=2, ymax=3, fill="#cf93b6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=4), ymin=1, ymax=2, fill="#f27c7e", alpha=0.5) +
  geom_text(mapping = aes(x = 0.4, y = 4.5, label = "good"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.4, y = 3.5, label = "fair"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.4, y = 2.5, label = "poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.4, y = 1.5, label = "very poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_hline(yintercept=4, linetype="dashed", color="gray55") +
  geom_hline(yintercept=3, linetype="dashed", color="gray55") +
  geom_hline(yintercept=2, linetype="dashed", color="gray55") +
  geom_bar(data=nace_bibi, aes(x=as.factor(x_axis), y=BIBI, fill=Year), 
           width=0.7, color="black", size=0.8, position="dodge", stat="identity") +
  scale_fill_manual(labels=c("2013", "2022"), values=c("gray60", "white")) +
  scale_x_discrete(name="Stream", labels=c((nace_bibi %>% group_by(stream_name) %>%
                                              summarise(mean_bibi <- mean(BIBI)))$stream_name))+
  ylab("Benthic Index of Biotic Integrity") +
  coord_cartesian(xlim=c(0.2, 3.6), ylim=c(0.8, 5), expand=F) +
  theme_bw(base_size=15) +
  geom_text(data=nace_bibi, aes(x=as.factor(x_axis), y=BIBI,
                                group=Year, label=BIBI), position=position_dodge2(width=0.7, preserve="total"), vjust=-0.5, size=6) +
  theme(axis.title.y=element_text(size=20, vjust=+3), axis.title.x=element_text(size=20, vjust=-0.75), axis.text.x=element_text(size=15),
        plot.margin = margin(t = 1, r = 1, b = 1, l = 1, unit = "cm"))

nace_bibi_graph

```


**Prince William**
*FIBI* (corrected)
```{r, echo=F}
##creating fibi data frame
prwi_fibi <- FIBI_scores2 %>%
  filter(Park=="PRWI") %>%
  filter(Stream!="MBCH") %>%
  filter(Stream!="NOBR") %>%
  mutate(x_axis=case_when(Stream=="BONE"~1,
                          Stream=="CARU"~2,
                          Stream=="MBBR"~3,
                          Stream=="MARU"~4,
                          Stream=="NFQC"~5,
                          Stream=="ORRU"~6,
                          Stream=="SFQC"~7,
                          Stream=="SORU"~8,
                          Stream=="TARU"~9)) %>%
  mutate(stream_name=case_when(Stream=="BONE"~"Boneyard Run",
                               Stream=="CARU"~"Carters Run",
                               Stream=="MBBR"~"Mary Byrd\nBranch",
                               Stream=="MARU"~"Mawavi Run",
                               Stream=="NFQC"~"North Fork\nQuantico Creek",
                               Stream=="ORRU"~"Orenda Run",
                               Stream=="SFQC"~"South Fork\nQuantico Creek",
                               Stream=="SORU"~"Sow Run",
                               Stream=="TARU"~"Taylor Run"))


##creating fibi graph
prwi_fibi_graph <- ggplot() +
  geom_rect(aes(xmin=0, xmax=10), ymin=4, ymax=5, fill="#7dc7ff", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=10), ymin=3, ymax=4, fill="#8ba7d6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=10), ymin=2, ymax=3, fill="#cf93b6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=10), ymin=1, ymax=2, fill="#f27c7e", alpha=0.5) +
  geom_text(mapping = aes(x = 0.25, y = 4.5, label = "good"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.25, y = 3.5, label = "fair"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.25, y = 2.5, label = "poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.25, y = 1.5, label = "very poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_hline(yintercept=4, linetype="dashed", color="gray55") +
  geom_hline(yintercept=3, linetype="dashed", color="gray55") +
  geom_hline(yintercept=2, linetype="dashed", color="gray55") +
  geom_bar(data=prwi_fibi, aes(x=as.factor(x_axis), y=FIBI, fill=Year),
           width=0.7,color="black", size=0.8, position="dodge", stat="identity") +
  scale_fill_manual(labels=c("2011", "2021"), values=c("gray60", "white")) +
  scale_x_discrete(name="Stream", labels=c((prwi_fibi %>% group_by(stream_name) %>%
                                              summarise(mean_fibi <- mean(FIBI)))$stream_name),
                   guide=guide_axis(angle = 40)) +
  ylab("Fish Index of Biotic Integrity") +
  coord_cartesian(xlim=c(0, 9.6), ylim=c(0.8, 5), expand=F) +
  theme_bw(base_size=15) +
  geom_text(data=prwi_fibi, aes(x=as.factor(x_axis), y=FIBI,
                                group=Year, label=FIBI), position=position_dodge2(width=0.7, preserve="total"), vjust=-0.5, size=4.5) +
  theme(axis.title.y=element_text(size=20, vjust=+3), axis.title.x=element_text(size=20, vjust=-0.75),
        plot.margin = margin(t = 1, r = 1, b = 1, l = 1, unit = "cm"))

prwi_fibi_graph

##plot dimensions: 981x645

```

*BIBI* (corrected)
```{r, echo=F}
##creating bibi dataframe
prwi_bibi <- BIBI_scores2 %>%
  filter(Park=="PRWI") %>%
  filter(Stream!="MBCH") %>%
  filter(Stream!="NOBR") %>%
  mutate(x_axis=case_when(Stream=="BONE"~1,
                          Stream=="CARU"~2,
                          Stream=="MBBR"~3,
                          Stream=="MARU"~4,
                          Stream=="NFQC"~5,
                          Stream=="ORRU"~6,
                          Stream=="SFQC"~7,
                          Stream=="SORU"~8,
                          Stream=="TARU"~9)) %>%
  mutate(stream_name=case_when(Stream=="BONE"~"Boneyard Run",
                               Stream=="CARU"~"Carters Run",
                               Stream=="MBBR"~"Mary Byrd\nBranch",
                               Stream=="MARU"~"Mawavi Run",
                               Stream=="NFQC"~"North Fork\nQuantico Creek",
                               Stream=="ORRU"~"Orenda Run",
                               Stream=="SFQC"~"South Fork\nQuantico Creek",
                               Stream=="SORU"~"Sow Run",
                               Stream=="TARU"~"Taylor Run"))


##creating bibi graph
prwi_bibi_graph <- ggplot() +
  geom_rect(aes(xmin=0, xmax=10), ymin=4, ymax=5, fill="#7dc7ff", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=10), ymin=3, ymax=4, fill="#8ba7d6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=10), ymin=2, ymax=3, fill="#cf93b6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=10), ymin=1, ymax=2, fill="#f27c7e", alpha=0.5) +
  geom_text(mapping = aes(x = 0.25, y = 4.5, label = "good"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.25, y = 3.5, label = "fair"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.25, y = 2.5, label = "poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.25, y = 1.5, label = "very poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_hline(yintercept=4, linetype="dashed", color="gray55") +
  geom_hline(yintercept=3, linetype="dashed", color="gray55") +
  geom_hline(yintercept=2, linetype="dashed", color="gray55") +
  geom_bar(data=prwi_bibi, aes(x=as.factor(x_axis), y=BIBI, fill=Year),
           width=0.7,color="black", size=0.8, position="dodge", stat="identity") +
  scale_fill_manual(labels=c("2011", "2021"), values=c("gray60", "white")) +
  scale_x_discrete(name="Stream", labels=c((prwi_bibi %>% group_by(stream_name) %>%
                                              summarise(mean_bibi <- mean(BIBI)))$stream_name),
                   guide=guide_axis(angle = 40)) +
  ylab("Benthic Index of Biotic Integrity") +
  coord_cartesian(xlim=c(0, 9.6), ylim=c(0.8, 5), expand=F) +
  theme_bw(base_size=15) +
  geom_text(data=prwi_bibi, aes(x=as.factor(x_axis), y=BIBI,
                                group=Year, label=BIBI), position=position_dodge2(width=0.7, preserve="total"), vjust=-0.5, size=4.5) +
  theme(axis.title.y=element_text(size=20, vjust=+3), axis.title.x=element_text(size=20, vjust=-0.75),
        plot.margin = margin(t = 1, r = 1, b = 1, l = 1, unit = "cm"))

prwi_bibi_graph

```


**Rock Creek**
*FIBI* (corrected)
```{r, echo=F}
##creating fibi data frame
rocr_fibi <- FIBI_scores2 %>%
  filter(Park=="ROCR") %>%
  filter(Stream!="SVPS") %>%
  mutate(x_axis=case_when(Stream=="BAKE"~1,
                          Stream=="BRBR"~2,
                          Stream=="DUOA"~3,
                          Stream=="FEBR"~4,
                          Stream=="KLVA"~5,
                          Stream=="LUBR"~6,
                          Stream=="NOST"~7,
                          Stream=="PHBR"~8,
                          Stream=="PYBR"~9,
                          Stream=="R630"~10,
                          Stream=="ROC3"~11)) %>%
  mutate(stream_name=case_when(Stream=="BAKE"~"Battery Kemble\nRun*‡",
                               Stream=="BRBR"~"Broad Branch",
                               Stream=="DUOA"~"Dumbarton Oaks*",
                               Stream=="FEBR"~"Fenwick Branch",
                               Stream=="KLVA"~"Klingle Valley*",
                               Stream=="LUBR"~"Luzon Branch",
                               Stream=="NOST"~"Normanstone Branch*",
                               Stream=="PHBR"~"Pinehurst Branch",
                               Stream=="PYBR"~"Piney Branch*",
                               Stream=="R630"~"Reservation 630",
                               Stream=="ROC3"~"Rock Creek\nDownstream of\nDumbarton Oaks‡"))


##creating fibi graph
rocr_fibi_graph <- ggplot() +
  geom_rect(aes(xmin=-0.1, xmax=12), ymin=4, ymax=5, fill="#7dc7ff", alpha=0.5) +
  geom_rect(aes(xmin=-0.1, xmax=12), ymin=3, ymax=4, fill="#8ba7d6", alpha=0.5) +
  geom_rect(aes(xmin=-0.1, xmax=12), ymin=2, ymax=3, fill="#cf93b6", alpha=0.5) +
  geom_rect(aes(xmin=-0.1, xmax=12), ymin=1, ymax=2, fill="#f27c7e", alpha=0.5) +
  geom_text(mapping = aes(x = 0.2, y = 4.5, label = "good"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.2, y = 3.5, label = "fair"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.2, y = 2.5, label = "poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.2, y = 1.5, label = "very poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_hline(yintercept=4, linetype="dashed", color="gray55") +
  geom_hline(yintercept=3, linetype="dashed", color="gray55") +
  geom_hline(yintercept=2, linetype="dashed", color="gray55") +
  geom_bar(data=rocr_fibi, aes(x=as.factor(x_axis), y=FIBI, fill=Cycle), 
           width=0.7, color="black", size=0.8, position="dodge", stat="identity") +
  scale_fill_manual(labels=c("2008, *14", "2019, ‡22"), values=c("gray60", "white")) +
  scale_x_discrete(name="Stream", labels=c((rocr_fibi %>% group_by(stream_name) %>%
                                              summarise(mean_fibi <- mean(FIBI)))$stream_name),
                   guide=guide_axis(angle = 40))+
  ylab("Fish Index of Biotic Integrity") +
  coord_cartesian(xlim=c(-0.1, 11.55), ylim=c(0.8, 5), expand=F) +
  theme_bw(base_size=15) +
  geom_text(data=rocr_fibi, aes(x=as.factor(x_axis), y=FIBI,
                                group=Year, label=FIBI), position=position_dodge2(width=0.7, preserve="total"), vjust=-0.5, size=3.5) +
  theme(axis.title.y=element_text(size=20, vjust=+3), axis.title.x=element_text(size=20, vjust=-0.75),
        plot.margin = margin(t = 1, r = 1, b = 1, l = 1, unit = "cm"))

rocr_fibi_graph

#figure dimensions: 1200x700

```

*BIBI* (corrected)
```{r, echo=F}
##creating bibi data frame
rocr_bibi <- BIBI_scores2 %>%
  filter(Park=="ROCR") %>%
  filter(Stream!="SVPS") %>%
  mutate(x_axis=case_when(Stream=="BAKE"~1,
                          Stream=="BRBR"~2,
                          Stream=="DUOA"~3,
                          Stream=="FEBR"~4,
                          Stream=="KLVA"~5,
                          Stream=="LUBR"~6,
                          Stream=="NOST"~7,
                          Stream=="PHBR"~8,
                          Stream=="PYBR"~9,
                          Stream=="R630"~10,
                          Stream=="ROC3"~11)) %>%
  mutate(stream_name=case_when(Stream=="BAKE"~"Battery Kemble\nRun*‡",
                               Stream=="BRBR"~"Broad Branch",
                               Stream=="DUOA"~"Dumbarton Oaks*",
                               Stream=="FEBR"~"Fenwick Branch",
                               Stream=="KLVA"~"Klingle Valley*",
                               Stream=="LUBR"~"Luzon Branch",
                               Stream=="NOST"~"Normanstone Branch*",
                               Stream=="PHBR"~"Pinehurst Branch",
                               Stream=="PYBR"~"Piney Branch*",
                               Stream=="R630"~"Reservation 630",
                               Stream=="ROC3"~"Rock Creek\nDownstream of\nDumbarton Oaks‡"))


##creating bibi graph
rocr_bibi_graph <- ggplot() +
  geom_rect(aes(xmin=-0.1, xmax=12), ymin=4, ymax=5, fill="#7dc7ff", alpha=0.5) +
  geom_rect(aes(xmin=-0.1, xmax=12), ymin=3, ymax=4, fill="#8ba7d6", alpha=0.5) +
  geom_rect(aes(xmin=-0.1, xmax=12), ymin=2, ymax=3, fill="#cf93b6", alpha=0.5) +
  geom_rect(aes(xmin=-0.1, xmax=12), ymin=1, ymax=2, fill="#f27c7e", alpha=0.5) +
  geom_text(mapping = aes(x = 0.2, y = 4.5, label = "good"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.2, y = 3.5, label = "fair"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.2, y = 2.5, label = "poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.2, y = 1.5, label = "very poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_hline(yintercept=4, linetype="dashed", color="gray55") +
  geom_hline(yintercept=3, linetype="dashed", color="gray55") +
  geom_hline(yintercept=2, linetype="dashed", color="gray55") +
  geom_bar(data=rocr_bibi, aes(x=as.factor(x_axis), y=BIBI, fill=Cycle), 
           width=0.7, color="black", size=0.8, position="dodge", stat="identity") +
  scale_fill_manual(labels=c("2008, *14", "2019, ‡22"), values=c("gray60", "white")) +
  scale_x_discrete(name="Stream", labels=c((rocr_bibi %>% group_by(stream_name) %>%
                                              summarise(mean_bibi <- mean(BIBI)))$stream_name),
                   guide=guide_axis(angle = 40))+
  ylab("Benthic Index of Biotic Integrity") +
  coord_cartesian(xlim=c(-0.1, 11.55), ylim=c(0.8, 5), expand=F) +
  theme_bw(base_size=15) +
  geom_text(data=rocr_bibi, aes(x=as.factor(x_axis), y=BIBI,
                                group=Year, label=BIBI), position=position_dodge2(width=0.7, preserve="total"), vjust=-0.5, size=3.5) +
  theme(axis.title.y=element_text(size=20, vjust=+3), axis.title.x=element_text(size=20, vjust=-0.75),
        plot.margin = margin(t = 1, r = 1, b = 1, l = 1, unit = "cm"))

rocr_bibi_graph

```


**Wolf Trap**
*FIBI* (corrected)
```{r, echo=F}
##creating fibi dataframe
wotr_fibi <- FIBI_scores2 %>%
  filter(Park=="WOTR") %>%
  mutate(x_axis=case_when(Stream=="CHCK"~1,
                          Stream=="WOTR"~2)) %>%
  mutate(stream_name=case_when(Stream=="CHCK"~"Courthouse Creek",
                               Stream=="WOTR"~"Wolf Trap Creek"))


##creating fibi graph
wotr_fibi_graph <- ggplot() +
  geom_rect(aes(xmin=0, xmax=3), ymin=4, ymax=5, fill="#7dc7ff", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=3), ymin=3, ymax=4, fill="#8ba7d6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=3), ymin=2, ymax=3, fill="#cf93b6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=3), ymin=1, ymax=2, fill="#f27c7e", alpha=0.5) +
  geom_text(mapping = aes(x = 0.45, y = 4.5, label = "good"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.45, y = 3.5, label = "fair"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.45, y = 2.5, label = "poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.45, y = 1.5, label = "very poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_hline(yintercept=4, linetype="dashed", color="gray55") +
  geom_hline(yintercept=3, linetype="dashed", color="gray55") +
  geom_hline(yintercept=2, linetype="dashed", color="gray55") +
  geom_bar(data=wotr_fibi, aes(x=as.factor(x_axis), y=FIBI, fill=Year), 
           width=0.7, color="black", size=0.8, position="dodge", stat="identity") +
  scale_fill_manual(labels=c("2012", "2022"), values=c("gray60", "white")) +
  scale_x_discrete(name="Stream", labels=c((wotr_fibi %>% group_by(stream_name) %>%
                                              summarise(mean_fibi <- mean(FIBI)))$stream_name))+
  ylab("Fish Index of Biotic Integrity") +
  coord_cartesian(xlim=c(0.3, 2.55), ylim=c(0.8, 5.01), expand=F) +
  theme_bw(base_size=15) +
  geom_text(data=wotr_fibi, aes(x=as.factor(x_axis), y=FIBI,
                                group=Year, label=FIBI), position=position_dodge2(width=0.7, preserve="total"), vjust=-0.5, size=6) +
  theme(axis.title.y=element_text(size=20, vjust=+3), axis.title.x=element_text(size=20, vjust=-0.75), axis.text.x=element_text(size=16),
        plot.margin = margin(t = 1, r = 1, b = 1, l = 1, unit = "cm"))

wotr_fibi_graph

##plot dimensions: 725x567

```

*BIBI* (corrected)
```{r, echo=F}
##creating bibi dataframe
wotr_bibi <- BIBI_scores2 %>%
  filter(Park=="WOTR") %>%
  mutate(x_axis=case_when(Stream=="CHCK"~1,
                          Stream=="WOTR"~2)) %>%
  mutate(stream_name=case_when(Stream=="CHCK"~"Courthouse Creek",
                               Stream=="WOTR"~"Wolf Trap Creek"))


##creating bibi graph
wotr_bibi_graph <- ggplot() +
  geom_rect(aes(xmin=0, xmax=3), ymin=4, ymax=5, fill="#7dc7ff", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=3), ymin=3, ymax=4, fill="#8ba7d6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=3), ymin=2, ymax=3, fill="#cf93b6", alpha=0.5) +
  geom_rect(aes(xmin=0, xmax=3), ymin=1, ymax=2, fill="#f27c7e", alpha=0.5) +
  geom_text(mapping = aes(x = 0.45, y = 4.5, label = "good"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.45, y = 3.5, label = "fair"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.45, y = 2.5, label = "poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_text(mapping = aes(x = 0.45, y = 1.5, label = "very poor"), color="black", size=5, angle=90, fontface="italic") +
  geom_hline(yintercept=4, linetype="dashed", color="gray55") +
  geom_hline(yintercept=3, linetype="dashed", color="gray55") +
  geom_hline(yintercept=2, linetype="dashed", color="gray55") +
  geom_bar(data=wotr_bibi, aes(x=as.factor(x_axis), y=BIBI, fill=Year), 
           width=0.7, color="black", size=0.8, position="dodge", stat="identity") +
  scale_fill_manual(labels=c("2012", "2022"), values=c("gray60", "white")) +
  scale_x_discrete(name="Stream", labels=c((wotr_bibi %>% group_by(stream_name) %>%
                                              summarise(mean_bibi <- mean(BIBI)))$stream_name))+
  ylab("Benthic Index of Biotic Integrity") +
  coord_cartesian(xlim=c(0.3, 2.55), ylim=c(0.8, 5.01), expand=F) +
  theme_bw(base_size=15) +
  geom_text(data=wotr_bibi, aes(x=as.factor(x_axis), y=BIBI,
                                group=Year, label=BIBI), position=position_dodge2(width=0.7, preserve="total"), vjust=-0.5, size=6) +
  theme(axis.title.y=element_text(size=20, vjust=+3), axis.title.x=element_text(size=20, vjust=-0.75), axis.text.x=element_text(size=16),
        plot.margin = margin(t = 1, r = 1, b = 1, l = 1, unit = "cm"))

wotr_bibi_graph

##plot dimensions:

```
